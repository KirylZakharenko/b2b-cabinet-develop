!function(t){"use strict";if(!t.JCBlankZakaza){t.JCBlankZakaza=function(e,a){this.arParams=a,this.obName=e,this.parameters=a.PARAMETERS,this.node=null,this.wrapper=null,BX.ready(BX.delegate(function(){this.init()},this)),t.addEventListener("load",this.updateScroll.bind(this)),t.addEventListener("popstate",function(t){location.reload()})},t.JCBlankZakaza.prototype={init:function(){this.node=document.getElementById(this.obName),this.wrapper=document.getElementById(this.obName+"_wrapper"),this.initHeaderSort(),this.initFullScreen(),this.initPagination(),this.initScroll(),this.initDetailLink(),BX.addCustomEvent("SidePanel.Slider:onMessage",this.eventOnMessage.bind(this))},initFullScreen:function(){this.wrapper.querySelector('a[data-action="fullscreen"]')?.addEventListener("click",this.clickFullScreen.bind(this))},initPagination:function(){let t=document.querySelectorAll(".pagination");t.forEach(t=>{t.parentNode.addEventListener("click",t=>{if(!t.target.closest(".page-link"))return;t.preventDefault();let e={},a=new URL(t.target.href);e.action="pagination",a.searchParams.get("SORT[CODE]")&&a.searchParams.get("SORT[ORDER]")&&(e.SORT_BY=a.searchParams.get("SORT[CODE]"),e.SORT_ORDER=a.searchParams.get("SORT[ORDER]")),e["PAGEN_"+this.arParams.NAV_PARAMS.NavNum]=a.searchParams.get("PAGEN_"+this.arParams.NAV_PARAMS.NavNum),e["SIZEN_"+this.arParams.NAV_PARAMS.NavNum]=a.searchParams.get("SIZEN_"+this.arParams.NAV_PARAMS.NavNum),e.url=a,BX.showWait(),this.sendRequest(e)})})},clickFullScreen:function(){event.stopPropagation();let t=event.target.closest(".catalog__section-wrapper"),e="card-fullscreen",a=t.classList.contains(e)?"init":"destroy";t.classList.toggle(e),t.classList.toggle("m-0"),t.classList.toggle("h-100"),t.querySelector(".catalog__search").classList.toggle("d-none"),$(this.wrapper).floatingScroll(a)},initHeaderSort:function(){this.node&&this.node.addEventListener("click",(function(){event.target.closest("[data-property-code]")&&this.changeSortHeader(event.target.closest("[data-property-code]"))}).bind(this))},initSidePanelDetailPage:function(){"Y"!==this.arParams.AJAX_MODE&&BX.loadExt("sidepanel").then((function(){BX.SidePanel.Instance.bindAnchors({rules:[{condition:[RegExp(location.pathname+"?\\S*"+this.arParams.ELEMENT_ID_VARIABLE+"=[0-9]+","i"),RegExp(location.pathname+"?\\S*([\\.\\-0-9a-zA-Z]+)(/?)([^/]*)","i")],stopParameters:["PAGEN_(\\d+)"],options:{width:1344,label:{text:"",color:"#FFFFFF",bgColor:"#3e495f",opacity:80}}}],handler:function(t,e){t.preventDefault(),BX.SidePanel.Instance.open(e,{})}})}).bind(this))},initScroll:function(){$(this.wrapper).floatingScroll()},updateScroll:function(){$(this.wrapper).floatingScroll("update")},initDetailLink:function(){this.wrapper.addEventListener("click",function(t){let e=null;(e=t.target.closest(".product__link"))&&(t.preventDefault(),BX.SidePanel.Instance.open(e.dataset.href,{width:1344,data:{outIdItem:e.dataset.idItem},label:{text:"",color:"#9E9E9E",bgColor:"transparent",opacity:80}}))})},eventOnMessage:function(e){let a;"addProductToBasketFromDetail"===e.eventId&&null!=t["ob"+e.data.obId]&&null!=(a=e.data.id==t["ob"+e.data.obId].itemId?t["ob"+e.data.obId].obQuantity:t["ob"+e.data.obId].getOfferById(e.data.id).obQuantity)&&(a.nodes.value.value=e.data.quantity,a.currentQuantity=e.data.quantity,a.tmpQuantity=e.data.quantity,BX.onCustomEvent("OnBasketChange"))},sendRequest:function(e){var a={siteId:this.arParams.SITE_ID,template:this.arParams.TEMPLATE,parameters:this.parameters,sotbit_set_site_template:this.arParams.SITE_TEMPLATE_SIGNS};this.arParams.AJAX_ID&&(a.AJAX_ID=this.arParams.AJAX_ID),BX.ajax({url:this.arParams.AJAX_PATH,method:"POST",dataType:"json",timeout:120,data:BX.merge(a,e),onsuccess:BX.delegate(function(a){BX.closeWait(),a&&a.JS&&(this.showAction(a,e),this.updateScroll(),BX.ajax.processScripts(BX.processHTML(a.JS).SCRIPT),t.history.pushState({urlPath:e.url.href},null,e.url.href))},this),onfailure(){BX.closeWait(),BX.onCustomEvent("B2BNotification",[BX.message("ERROR_SORT"),"alert"])}})},showAction:function(t,e){if(e.action)switch(e.action){case"sort":this.processUpdate(t,e);break;case"pagination":this.processUpdate(t,e),$(".fl-scrolls").floatingScroll("update")}},processUpdate:function(t,e){t&&(this.node.querySelectorAll("tbody").forEach(t=>t.remove()),this.processTableHeader(t.tableHeader),this.processItems(t.items),this.processPagination(t.pagination,e),this.processEpilogue(t.epilogue),BX.type.isNotEmptyString(t.parameters)&&this.processParameters(t.parameters))},processTableHeader:function(t){if(!t)return;let e=BX.processHTML(t,!1);this.node.querySelector(".blank-zakaza__header").innerHTML=e.HTML,this.initFullScreen(),BX.ajax.processScripts(e.SCRIPT)},processItems:function(t){if(!t)return;let e=BX.processHTML(t,!1),a=BX.create("template");a.innerHTML=e.HTML,this.node.appendChild(a.content),BX.ajax.processScripts(e.SCRIPT)},processPagination:function(t,e){if(!t)return;let a=BX.create("template");a.innerHTML=t,a.content.querySelectorAll(".page-link").forEach(t=>{if(t.href){let a=new URL(t.href,e.url.origin);e.SORT_BY&&e.SORT_ORDER&&(a.searchParams.set("SORT[CODE]",e.SORT_BY),a.searchParams.set("SORT[ORDER]",e.SORT_ORDER)),t.setAttribute("href",a.href)}}),document.querySelectorAll(".pagination").forEach(t=>t.parentNode.innerHTML=a.innerHTML)},processEpilogue:function(t){if(t){var e=BX.processHTML(t,!1);BX.ajax.processScripts(e.SCRIPT)}},processParameters:function(t){this.parameters=t},changeSortHeader:function(t){let a="ASC",r,s={},i=new URL(location);a=(i.searchParams.get("SORT[ORDER]")||a)===a?"DESC":"ASC","QUANTITY"!==t.dataset.propertyCode&&"OFFERS"!==t.dataset.propertyCode&&(r=e[t.dataset.propertyCode]?e[t.dataset.propertyCode]:t.dataset.propertyCode,t.dataset.sortOrder=a,this.prevNode?this.changeArrowForSort(this.prevNode,t):this.wrapper.querySelectorAll(".blank-zakaza__header-property").forEach(e=>this.changeArrowForSort(e,t)),t.classList.add("active"),this.prevNode=t,i.searchParams.set("SORT[CODE]",r),i.searchParams.set("SORT[ORDER]",a),s.url=i,s.action="sort",s.SORT_BY=r,s.SORT_ORDER=a,s["PAGEN_"+this.arParams.NAV_PARAMS.NavNum]=i.searchParams.get("PAGEN_"+this.arParams.NAV_PARAMS.NavNum),s["SIZEN_"+this.arParams.NAV_PARAMS.NavNum]=i.searchParams.get("SIZEN_"+this.arParams.NAV_PARAMS.NavNum),BX.showWait(),this.sendRequest(s))},changeArrowForSort:function(t,e){t!==e&&(t.classList.remove("active"),t.dataset.sortOrder="")}};var e={NAME:"NAME",AVALIABLE:"QUANTITY",MEASURE:"MEASURE"}}}(window);